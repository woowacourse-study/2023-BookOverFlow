# 05. HTTP와 연계하는 웹 서버

## 멀티 도메인을 가능하게 하는 가상 호스트

- 멀티 도메인
    - 하나의 HTTP 서버에 여러 개의 웹 사이트를 실행할 수 있다.
    - 이를 위해 **가상 호스트 (Virtual Host)** 기능을 사용
- 가상 호스트
    - 물리적으로는 서버가 1대
    - 가상으로 여러 대가 있는 것처럼 설정
- 기존
    
    클라이언트가 서버에 액세스 하기 위해 도메인/호스트 명을 사용
    
    → 도메인명은 DNS에 의해 IP 주소로 변환
    
    → 리퀘스트가 서버에 도착했을 때, IP 주소를 기준으로 액세스
    
    →어떤 도메인에 대한 액세스인지 알 수 없음!
    
- 그러므로, 호스트명과 도메인 명을 **완전하게 포함한 URI**를 지정하거나, **Host 헤더 필드**에서 지정해야 한다.

## 통신을 중계하는 프로그램: 프록시, 게이트웨이, 터널

- HTTP는 클라이언트—서버 이외에, 통신을 중계하는 프로그램 — 서버 연계도 가능
- 다음에 있는 다른 서버에 리퀘스트를 중계하고, 그 서버로부터 받은 리스폰스를 클라이언트에 반환하는 역할

### 프록시 (Proxy)

- 서버—클라이언트 양쪽 역할을 하는 중계 프로그램
    - 리퀘스트를 서버에 전송하고, 리스폰스를 클라이언트에 전송
- 클라이언트로부터 리퀘스트를 받으면,
    
    리퀘스트 URI를 변경하지 않고, 오리진 서버(다음의 리소스를 갖고 있는 서버)에 전송
    
- 오리진 서버로부터 리스폰스를 받으면,
    
    프록시 서버를 경유해서 클라이언트에 돌아옴
    
- 프록시 서버 여러 대를 경유하는 것도 가능
    - via 헤더 필드에 경유한 호스트 정보를 추가해주어야 함

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/d4809f18-a915-4e30-8b11-8f015eacff00/6ae56406-cd18-40e1-addf-a71951b03175/Untitled.png)

- 프록시 서버를 사용하는 이유
    - 캐시를 사용해서 네트워크 대역 등을 효율적으로 사용하는 것
    - 조직 내에 특정 웹 사이트에 대한 액세스 제한
    - 액세스 로그를 획득하는 정책을 철저히 지키려는 목적
- 프록시 사용 방법 — 분류하는 기준
    - 캐시 하는지 안하는지 여부 → `캐싱 프록시` (캐시o)
    - 메시지를 변경하는지 안하는지 여부 → `비투과 프록시` (변경o) / `투명 프록시` (변경x)
    

### 게이트웨이 (Gateway)

- 다른 서버를 중계하는 서버
    - 리퀘스트를 본인이 서버인 것처럼 수신함
- 게이트 웨이 다음에 있는 서버 → HTTP 이외의 서버
- 클라이언트—게이트웨이 사이를 암호화하는 등 안전하게 접속함으로써 **통신의 안정성을 높이는 역할**
    - e.g. 데이터베이스에 접속해 SQL 쿼리를 사용하여 데이터를 얻는 곳에 이용 가능
        
        쇼핑 사이트 등에서 신용 카드 결제 시스템 등과 연계할 때 사용 가능
        

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/d4809f18-a915-4e30-8b11-8f015eacff00/1fae9c9c-0620-406a-8a8b-7019b1fac098/Untitled.png)

### 터널 (Tunnel)

- 두 대의 클라이언트와 서버 사이를 중계하며 접속을 주선
- 요구에 따라 다른 서버와의 통신 경로를 확립
- 이 때, 클라이언트는 SSL 같은 암호화 통신을 통해 **서버와 안전하게 통신하기 위하여** 사용

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/d4809f18-a915-4e30-8b11-8f015eacff00/28a0d3d1-71bc-4add-9d9d-8a4eae99e84f/Untitled.png)

## 리소스를 보관하는 캐시

### 캐시

- 프록시 서버와 클라이언트 로컬 디스크에 보관된 리소스의 사본
- 서버에 액세스하는 것을 줄임으로써 **통신량과 통신 시간 절약**
- `캐시 서버`: 프록시 서버의 하나로, 캐싱 프록시로 분류됨
- 장점
    - 같은 데이터를 몇 번이고 오리진 서버에 전송할 필요가 없음
    - 서버는 같은 리퀘스트를 매번 처리할 필요 없음

### 캐시의 유효기간

- 오리진 서버에 있는 원래의 리소스가 갱신되는 경우에도 캐시 서버는 낡은 리소스를 그대로 보내게 됨
- 이를 방지하기 위해, 클라이언트의 요구나 캐시의 유효 기간 등에 의해서
    
    오리진 서버에 리소스의 유효성을 확인하거나, 새로운 리소스를 다시 획득하러 가게 되는 경우가 있음
    

### 클라이언트 측의 캐시

- 클라이언트가 사용하는 브라우저에서도 캐시를 가질 수 있다.
    - 인터넷 익스플로러에서 보존하는 캐시: `인터넷 임시 파일`
- 브라우저가 유효한 캐시를 갖고 있는 경우 → 같은 리소스의 액세스는 로컬 디스크로부터 불러옴
- 오리진 서버에 리소스의 유효성을 확인하거나, 새로운 리소스를 다시 획득하러 가게 되는 경우가 있음