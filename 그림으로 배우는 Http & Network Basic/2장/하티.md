# 02. 간단한 프로토콜 HTTP

## HTTP 통신

### HTTP: 클라이언트—서버 간의 통신

- 클라이언트: 리소스를 필요로하는 쪽
- 서버: 리소스를 제공하는 쪽

### 리퀘스트 — 리스폰스 교환

- 클라이언트 `리퀘스트 (Request)` → 서버 `리스폰스 (Response)`
- 리퀘스트 메시지
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/d4809f18-a915-4e30-8b11-8f015eacff00/b0377ead-0928-474d-8174-bd80da6c8170/Untitled.png)
    
    - 메소드 (e.g. GET, POST)
    - URI
    - 프로토콜 버전 (e.g. HTTP/1.1)
    - 리퀘스트 헤더 필드
    - 엔티티
- 리스폰스 메시지
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/d4809f18-a915-4e30-8b11-8f015eacff00/f317172f-b77b-4613-aa35-2e66f88b3fee/Untitled.png)
    
    - 프로토콜 버전
    - 상태 코드
    - 상태 코드 설명
    - 리스폰스 헤더 필드
    - 바디

## 상태를 유지하지 않는 프로토콜

- HTTP는 stateless protocol
    - HTTP 독자적으로 상태를 관리하지 않음
    - 즉, 리퀘스트, 리스폰스에 대해 기억하지 않음
- 새로운 리퀘스트 → 새로운 리스폰스 생성
- 과거 정보 전혀 보유하지 않음 → 많은 데이터를 매우 빠르고 확실하게 처리하는 **범위성(scalability)**을 확보하기 위함
- 상태를 유지하고 싶다면? → Cookie

## 리퀘스트 URI로 리소스 식별

- HTTP는 URI를 사용하여 인터넷 상의 리소스를 지정
- (1) 모든 URI를 리퀘스트 URI에 포함한다.
    
    ```
    GET http://hackr.jp/index.htm HTTP/1.1
    ```
    
- (2) HOST 헤더 필드에 네트워크 로케이션을 포함한다.
    
    ```
    GET /index.htm HTTP/1.1
    Host: hackr.jp
    ```
    

## HTTP 메소드

- `GET`: 리소스 획득
- `POST`: 엔티티 전송
- `PUT`: 파일 전송
    - 보안 상의 문제 有
    - 인증 기능과 짝을 이루거나 / REST와 같이 웹끼리 연계하는 경우 등에 사용되기도 함
- `HEAD`: 메시지 헤더 취득
    - GET과 같지만 메시지 바디는 돌려주지 않음
    - URI 유효성과 리소스 갱신 시간 확인 등
- `DELETE`: 파일 삭제
    - response: 204 No Content
    - 보안 상의 문제 有
    - 인증 기능과 짝을 이루거나 / REST와 같이 웹끼리 연계하는 경우 등에 사용되기도 함
- `OPTIONS`: 제공하고 있는 메소드의 문의
    - response: 서버가 제공하고 있는 메소드를 되돌려준다.
- `TRACE`: 경로 조사
    - 웹 서버에 접속해서 자신에게 통신을 되돌려 받는 루프백(loop-back)을 발생시킴
    - 프록시 등을 중계하여 origin 서버에 접속할 때 동작을 확인하기 위함
    - 보안 상의 문제 등으로 보통 사용하지 않음.
- `CONNECT`: 프록시에 터널링 요구
    - TCP 통신을 터널링 시키기 위함
    - 주로 SSL, TLS 등의 프로토콜로 암호화된 것을 터널링하기 위해 사용

## 지속 연결 (Persistent Connections)

- 기존, HTTP 통신을 할 때마다 매번 TCP에 의해 연결과 종료가 필요했음 → 통신량이 쓸데없이 증가함
- 지속 연결: 어느 한 쪽이 명시적으로 연결을 종료하지 않으면 TCP 연결을 계속 유지
- TCP 연결 및 종료를 반복하는 오버헤드 감소 
→ 서버에 대한 부하 경감, 리퀘스트/리스폰스 속도 빨라져서 웹페이지 로딩 빨라짐
- 파이프라인화 (HTTP pipelining) 가능해짐
    - 리스폰스를 기다리지 않고 바로 다음 리퀘스트를 보낼 수 있음
    - 리퀘스트를 병행해서 보내는 것이 가능해짐

## 쿠키 (cookie)

- stateless protocol
    - 장점: 서버의 CPU, 메모리 등의 리소스 소비 억제
    - 단점: 과거 상태를 근거로 한 리퀘스트 처리 (e.g. 로그인 상태 유지) 불가능
- 쿠키: 리퀘스트와 리스폰스에 쿠키 정보를 추가하여 클라이언트의 상태를 파악하기 위한 시스템
    - 리스폰스의 Set-Cookie 헤더 필드에 담아 보낸 쿠키를 클라이언트에 보존한다.
    - 클라이언트가 동일 서버로 리퀘스트를 보낼 때, 해당 쿠키 값을 자동으로 넣어서 송신한다.