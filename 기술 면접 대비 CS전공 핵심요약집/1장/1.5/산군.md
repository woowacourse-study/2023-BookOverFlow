# 1.5(가상 메모리)

## 1.5.1 가상 메모리란(virtual memory)(⭐⭐⭐)

- **가상 메모리는 프로세스의 일부만 메모리에 로드하고, 나머지는 디스크에 둔 상태로 프로세스를 실행하는 방식이다.**

![Untitled](1%205(%E1%84%80%E1%85%A1%E1%84%89%E1%85%A1%E1%86%BC%20%E1%84%86%E1%85%A6%E1%84%86%E1%85%A9%E1%84%85%E1%85%B5)%20634ab40d863f4732bbe6a930c3b78765/Untitled.png)

- 가상 메모리의 장점은 다음과 같다.
    - 프로그램이 메모리 크기에 대한 제약을 덜 받을 수 있다.
    - 동시에 많은 프로그램을 실행하므로 CPU 이용률과 처리율을 높일 수 있다.
    - 필요한 영역만 메모리에 로드해 스와핑 횟수를 줄여서 프로그램 실행 속도를 높일 수 있다.

## 1.5.2 요구 페이징(demand paging)(⭐⭐⭐)

- **요구 페이징은 프로세스에서 필요한 페이지만 메모리에 로드하는 방식이다.**
- 초기에 필요한 영역만 로드한 후 다른 영역은 요청이 올 때 메모리에 로드한다.

![Untitled](1%205(%E1%84%80%E1%85%A1%E1%84%89%E1%85%A1%E1%86%BC%20%E1%84%86%E1%85%A6%E1%84%86%E1%85%A9%E1%84%85%E1%85%B5)%20634ab40d863f4732bbe6a930c3b78765/Untitled%201.png)

- 프로그램을 실행하다가 물리 메모리에 필요한 페이지가 없을 때 이를 **페이지 폴트(page fault)**라고 한다.
    - 페이지 폴트가 발생하면 디스크에서 필요한 페이지를 스왑 인한다.
    - 페이지에 해당하는 메모리 영역이 물리 메모리에 있는지는 페이지 테이블로 파악할 수 있다.
        - 페이지 테이블은 페이지에 해당하는 프레임이 존재하면 ‘v(valid)’ 값을, 프레임이 존재하지 않거나 유효하지 않은 주소 값이면 ‘i(invalid)’ 값을 반환한다.

![Untitled](1%205(%E1%84%80%E1%85%A1%E1%84%89%E1%85%A1%E1%86%BC%20%E1%84%86%E1%85%A6%E1%84%86%E1%85%A9%E1%84%85%E1%85%B5)%20634ab40d863f4732bbe6a930c3b78765/Untitled%202.png)

## 1.5.3 스레싱(thrashing)(⭐⭐⭐)

- **스레싱은 동시에 일정 수 이상의 프로그램을 실행했을 때 오히려 CPU 이용률이 떨어지는 상황을 말한다.**
- 가상 메모리를 구현해 다중 프로그래밍을 하면 CPU 이용률이 높아진다.
- 하지만 일정 수 이상으로 다중 프로그래밍을 하면 페이지 폴트가 자주 일어난다.
    - 스와핑 횟수가 증가한다.

![Untitled](1%205(%E1%84%80%E1%85%A1%E1%84%89%E1%85%A1%E1%86%BC%20%E1%84%86%E1%85%A6%E1%84%86%E1%85%A9%E1%84%85%E1%85%B5)%20634ab40d863f4732bbe6a930c3b78765/Untitled%203.png)

- 스레싱을 예방하려면 **워킹 세트(working set)**를 설정하는 방법이 있다.
- **워킹 세트는 지역성을 기반으로 자주 사용하는 페이지를 저장해 두는 것을 의미한다.**
    - 워킹 세트를 바탕으로 자주 사용하는 페이지를 물리 메모리 프레임에 고정하면 페이지 폴트가 빈번하게 발생하는 현상을 방지할 수 있다.
    - 물리 메모리에 캐싱하는 느낌