# 1.3(스케줄링)

## 1.3.1 스케줄링의 목적(⭐)

- **스케줄링의 주된 목적은 멀티 프로세스 환경에서 모든 프로세스를 공평하게 실행하는 것이다.**
- 세부적으로는 다음과 같이 5가지 목적이 있다.
    - 공평성: 모든 프로세스가 공평하게 실행되어야 한다.
    - 효율성: 자원을 효율적으로 사용해 낭비되는 시간이 없도록 해야 한다.
    - 안정성: 우선순위를 고려해 높은 우선순위의 프로세스를 먼저 처리하도록 한다.
    - 반응 시간 보장: 프로세스가 오랜 시간 응답이 없으면 사용자는 시스템이 멈춘 것으로 보기 때문에 일정 시간 내에 응답할 수 있도록 해야 한다.
    - 무한 연기 방지: 특정 프로세스에 대한 처리가 무한히 연기되지 않도록 한다.

## 1.3.2 스케줄링의 단계(⭐⭐⭐)

- **장기 스케줄링(long-term scheduling)**
    - 준비 큐에 어떤 프로세스를 넣을지 결정해 메모리에 올라가는 프로세스 수를 조절한다.
    - 잡 스케줄링(job scheduling) 또는 승인 스케줄링(admission scheduling)이라고도 한다.
    - 현대 운영체제에서는 시분할 시스템을 사용하기 때문에 대부분 사용하지 않는다.
- **중기 스케줄링(mid-term scheduling)**
    - 메모리에 로드된 프로세스 수를 동적으로 조절한다.
    - 메모리에 프로세스가 많이 로드되면 스왑 아웃(swap out)해서 일부 프로세스를 통째로 저장한다.
    - 스왑 아웃된 프로세스는 중단 상태(suspended)가 된다.
- **단기 스케줄링(short-term scheduling)**
    - 준비 큐에 있는 대기 상태 프로세스 중 어떤 프로세스를 다음으로 실행할지 스케줄링 알고리즘으로 결정한다.
    - 이를 CPU 스케줄링이라고도 한다.

![Untitled](1%203(%E1%84%89%E1%85%B3%E1%84%8F%E1%85%A6%E1%84%8C%E1%85%AE%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BC)%20dd5870804dc9485bad5db9d2ad1d3117/Untitled.png)

![Untitled](1%203(%E1%84%89%E1%85%B3%E1%84%8F%E1%85%A6%E1%84%8C%E1%85%AE%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BC)%20dd5870804dc9485bad5db9d2ad1d3117/Untitled%201.png)

- 스왑 아웃(swap out): 중기 스케줄러가 이벤트 발생을 기다리고 있는 프로세스를 통째로 저장공간으로 옮겨 저장하는 것을 스왑 아웃이라고 한다.
- 스왑 인(swap in): 스왑 아웃한 프로세스에서 이벤트 요청이 오면 해당 프로세스를 통째로 다시 메모리에 로드하는 것을 스왑 인이라고 한다.
- 스와핑(swapping): 스왑 아웃과 스왑 인처럼 프로세스를 통째로 메모리 영역과 저장 공간으로 옮기는 것을 스와핑이라고 한다.

## 1.3.3 스케줄링 알고리즘(⭐⭐⭐)

- **스케줄링 알고리즘은 CPU 스케줄러(단기 스케줄러)가 준비 큐에 있는 프로세스 중 어떤 프로세스를 실행시킬지 결정하는 데 사용한다.**
- 스케줄링의 목적을 달성하기 위해 다음과 같은 기준으로 평가한다.
    - CPU 사용률: CPU를 놀리지 않고 사용하는지 판단
    - 처리량: 단위 시간당 실행한 프로세스 수
    - 응답 시간: 프로세스에 요청이 발생했을 때 응답까지 걸리는 시간
    - 반환 시간: 프로세스가 로드된 이후부터 종료될 때까지 걸리는 시간
    - 대기 시간: 프로세스가 대기 큐에서 대기하는 시간의 총합
- 스케줄링 알고리즘은 비선점형과 선점형으로 나뉜다.

### 비선점형 스케줄링(non-preemptive scheduling)

- **비선점형 스케줄링은 실행 중인 프로세스가 종료될 때까지 다른 프로세스를 실행할 수 없음을 의미한다.**
- FCFS(First Come First Served): 준비 큐에 먼저 들어온 프로세스가 우선순위를 갖는다.
- SJF(Shortest Job First): 실행 시간이 짧은 프로세스가 우선순위를 갖는 알고리즘으로, SJN(Shortest Job Next) 스케줄링이라고도 한다.
    - 우선 순위가 낮은 프로세스는 계속 실행되지 못하는 기아 상태를 유발한다.
    - 이전 결과를 바탕으로 예상 실행 시간 예측
- HRRN(Highest Response Ratio Next): 준비 큐에 있는 프로세스들 중에서 응답률이 가장 높은 프로세스에게 우선순위를 준다.
    - 대기시간이 올라갈 수록 응답률이 높아진다.

### 선점형 스케줄링(preemptive scheduling)

- **선점형 스케줄링은 스케줄러가 실행 중인 프로세스를 중단시키고 다른 프로세스를 실행할 수 있음을 의미한다.**
    - 다른 프로세스를 실행시키는 트리거는 다른 프로세스가 준비 큐에 들어올 때 비교가 시행된다.
- RR(Round Robin): 비선점형 스케줄링과 달리 프로세스 간 우선순위가 없다. 모든 프로세스를 순서대로 일정 시간 동안 실행하며, 일정 시간을 초과하면 다른 프로세스를 실행한다.
    - 여기서 일정 시간은 시간단위를 의미하며 ‘타임 퀀텀(time quantum)’ 또는 ‘타임 슬라이스(time slice)’라고도 한다.
        - 시간 단위가 커지면 FCFS 알고리즘과 똑같아진다.
        - 오버헤드도 커진다.
    - 컨텍스트 스위칭이 빈번하게 일어나 오버헤드가 크다는 단점이 있지만 모든 프로세스가 반복 수행되어 응답 속도가 빠르다는 장점도 있다.
- SRTF(Shortest Remaining Time First): 준비 큐에서 대기 시간이 가장 짧게 남은 프로세스를 우선 수행하는 알고리즘이다.
    - 한 프로세스가 실행 중일 때 실행 시간이 더 짧은 프로세스가 준비 큐에 들어오면 실행 시간이 더 짧은 프로세스가 CPU를 차지한다.
        - 기아 상태를 유발한다.
- 멀티 레벨(multi level): 준비 큐를 목적에 따라 여러 개로 분리해 사용하는 알고리즘이다.
    - 분리한 큐는 각각 우선순위가 있고 각자 다른 스케줄링 알고리즘을 적용할 수 있다.
    - 여러 개의 큐는 각각 foreground, background로 나뉜다.
    - foreground에는 응답속도가 중요한 프로세스, background에는 성능을 중요시하는 프로세스가 들어간다.

### 스케줄링 예제

![Untitled](1%203(%E1%84%89%E1%85%B3%E1%84%8F%E1%85%A6%E1%84%8C%E1%85%AE%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BC)%20dd5870804dc9485bad5db9d2ad1d3117/Untitled%202.png)

![Untitled](1%203(%E1%84%89%E1%85%B3%E1%84%8F%E1%85%A6%E1%84%8C%E1%85%AE%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BC)%20dd5870804dc9485bad5db9d2ad1d3117/Untitled%203.png)

- FCFS 스케줄링이므로 순차적으로 실행된다.
- 평균 대기 시간은 290이다.

![Untitled](1%203(%E1%84%89%E1%85%B3%E1%84%8F%E1%85%A6%E1%84%8C%E1%85%AE%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BC)%20dd5870804dc9485bad5db9d2ad1d3117/Untitled%204.png)

- 평균 대기 시간은 218이다.

![Untitled](1%203(%E1%84%89%E1%85%B3%E1%84%8F%E1%85%A6%E1%84%8C%E1%85%AE%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BC)%20dd5870804dc9485bad5db9d2ad1d3117/Untitled%205.png)

- 선점형 스케줄링인 RR 스케줄링이며, 이때 시간 단위는 50이다.
- RR 스케줄링에서 응답 요청에 대한 대기 시간은 [(전체 프로세스 수 - 1) * 시간단위] 이다.
- 컨텍스트 스위칭이 빈번하다.

![Untitled](1%203(%E1%84%89%E1%85%B3%E1%84%8F%E1%85%A6%E1%84%8C%E1%85%AE%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BC)%20dd5870804dc9485bad5db9d2ad1d3117/Untitled%206.png)

- 선점형 스케줄링인 SRTF 스케줄링이다.
- 남은 실행시간
- 평균 대기 시간은 202이다.
- 프로세스 간 기아상태가 되기 쉽다.

![Untitled](1%203(%E1%84%89%E1%85%B3%E1%84%8F%E1%85%A6%E1%84%8C%E1%85%AE%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BC)%20dd5870804dc9485bad5db9d2ad1d3117/Untitled%207.png)

- 목적에 맞춰 우선순위를 조정해 큐를 나누어 관리한다.