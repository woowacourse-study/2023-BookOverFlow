# 17장. 셀렉트

## select

- 코루틴에서 가장 먼저 완료되는 코루틴의 결과를 기다리는 `select` 함수를 제공함
- 버퍼에 남는 공간이 있는 채널을 먼저 확인해서 데이터를 보내거나, 채널로부터 데이터를 받을 수 있는지 여부도 확인 가능
- 코루틴 사이에 경합을 일으키거나, 여러 개의 데이터 소스로부터 나오는 결괏값 합치기 가능

## 지연되는 값 선택하기

- pov: 여러 개의 소스에 데이터를 요청한 뒤, 가장 빠른 응답만 얻는 경우
- 여러 개의 비동기 프로세스로 시작한 뒤, `select` 함수를 표현식으로 사용하고 표현식 내부에서 값을 기다리는 방법
    - `select` 내부 > 셀렉트 표현식에서 나올 수 있는 결과값을 명시하는 Deferred 값의 onAwait 함수를 호
    - select 표현식이 하나의 비동기 작업이 완료됨과 동시에 끝, 결과값 반환
    

## 채널에서 값 선택하기

- 채널에서도 `select` 함수 사용 가능
- 셀렉트 표현식에서 사용하는 주요 함수
    - onReceive
        - 채널이 값을 가지고 있을 때 선택됨
        - 값을 받은 뒤 람다식의 인자로 사용
        - onReceive 선택되면, select는 람다식의 결과값을 반환
    - onReceiveCatching
        - 채널이 값을 가지고 있거나 닫혔을 때 선택됨
        - ChannelResult를 받아 람다식의 인자로 사용
        - onReceiveCatching 선택되면, select는 람다식의 결과값을 반환
    - onSend
        - 채널에 버퍼 공간이 있을 때 선택됨
        - 채널에 값을 보낸 뒤, 채널의 참조값으로 람다식 수행
        - onSend 선택되면, select는 Unit을 반환
    

## 요약

- `select`는
    - 가장 먼저 완료되는 코루틴의 결과값을 기다릴 때,
    - 여러 개의 채널 중 전송 또는 수신 가능한 채널을 선택할 때
    
    유용함
    
- 채널에서 작동하는 다양한 패턴을 구현할 때 주로 사용되고,
    
    async 코루틴의 경합을 구현할 때도 사용 가능
